<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html >
    <head>
        <meta charset="utf-8"/>
        <title>Twittermap</title>

        <!--                integrating jQuery (outside the jvm sources)-->
        <script src="//code.jquery.com/jquery-1.9.1.js"></script>
        <script src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
        <style>#slider { margin: 10px; }	</style>
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        <!--                integrate the jVectorMap files-->

        <link rel="stylesheet" href="jvmSources/jvectormap/jquery-jvectormap-1.2.2.css"/>
        <script src="jvmSources/jvectormap/jquery-jvectormap-1.2.2.min.js"></script>
        <script type="text/javascript" src="gdp-data.js"></script>
        <!--        <script src="assets/jquery-1.8.2.js"></script>-->
        <script src="jvmSources/jquery-jvectormap.js"></script>
        <script src="jvmSources/jquery-mousewheel.js"></script>
        <script src="jvmSources/lib/jvectormap.js"></script>
        <script src="jvmSources/lib/abstract-element.js"></script>
        <script src="jvmSources/lib/abstract-canvas-element.js"></script>
        <script src="jvmSources/lib/abstract-shape-element.js"></script>
        <script src="jvmSources/lib/svg-element.js"></script>
        <script src="jvmSources/lib/svg-group-element.js"></script>
        <script src="jvmSources/lib/svg-canvas-element.js"></script>
        <script src="jvmSources/lib/svg-shape-element.js"></script>
        <script src="jvmSources/lib/svg-path-element.js"></script>
        <script src="jvmSources/lib/svg-circle-element.js"></script>
        <script src="jvmSources/lib/vml-element.js"></script>
        <script src="jvmSources/lib/vml-group-element.js"></script>
        <script src="jvmSources/lib/vml-canvas-element.js"></script>
        <script src="jvmSources/lib/vml-shape-element.js"></script>
        <script src="jvmSources/lib/vml-path-element.js"></script>
        <script src="jvmSources/lib/vml-circle-element.js"></script>
        <script src="jvmSources/lib/vector-canvas.js"></script>
        <script src="jvmSources/lib/simple-scale.js"></script>
        <script src="jvmSources/lib/numeric-scale.js"></script>
        <script src="jvmSources/lib/ordinal-scale.js"></script>
        <script src="jvmSources/lib/color-scale.js"></script>
        <script src="jvmSources/lib/data-series.js"></script>
        <script src="jvmSources/lib/proj.js"></script>
        <script src="jvmSources/lib/world-map.js"></script>
        <script src="jvmSources/assets/jquery-jvectormap-world-mill-en.js"></script>

        <script type="text/javascript">
            /*
             *This function gets the data from an extern JSON file and 
             *initialises the world map. Furthermore it draws markers on the 
             *map, symbolizing the location of the tweet and its source showed
             *by the colour of the marker. Information about the Tweet ( hashtags,
             *links ) are shown in a tooltip when hovering with the mouse over a
             *marked Tweet   
             */
             
            function showMap() { 
                $(function(){ 
                    //load the data via ajax request
                    $.getJSON('DataFile1.json',function(data){
                        var val=1;
                        var twitterSource = Array.prototype.concat.apply([], jvm.values(data.tweets.source));
                        
                        //draw the map including markers
                        $('#world-map-markers').vectorMap({
                            map: 'world_mill_en',
                            scaleColors: ['#C8EEFF', '#0071A4'],
                            normalizeFunction: 'polynomial',
                            hoverOpacity: 0.7,
                            hoverColor: false,
                            backgroundColor: 'cornflowerblue', 
                            markers: data.tweets.geolocation,
                            series: {
                                markers: [{
                                        attribute: 'fill',
                                        scale: {
                                            '1': '#00ff00',
                                            '2': '#FF69B4',
                                            '3': '#4169E1',
                                            '4': '#ffff00',
                                            '5': '#000000'
                                        },
                                        values: data.tweets.source,
                                        min: jvm.min(twitterSource),
                                        max: jvm.max(twitterSource)
                                    }]
                            },
                            onMarkerLabelShow: function(event, label, index){
                                label.html(
                                '<b>Tweet ID:</b> '+data.tweets.id[index]+'<br/>'+
                                    '<b>Hashtags: </b>'+data.tweets.hashtags[index]+'<br/>'+
                                    '<b>Links: </b>'+data.tweets.links[index]
                            );
                            }  
                        });
                        var mapObject = $('#world-map-markers').vectorMap('get', 'mapObject');
                        
                        $("#slider").slider(
                        {
                            range: "min",
                            value: 0,
                            min: 0,
                            max: 23,
                            //step: 1,
                            slide: function( event, ui ) {
                                /* next target: slider should manipulate the map
                                 * by drawing markers on the map dependent on 
                                 * the timestamp of every tweet. E.g. show the 
                                 * change over a day*/ 
                            }
                        }
                    );
                        //                        
                    });    
                });            
            } 
        </script>
    </head>

    <body>

        <!--        Map-->
        <div id="world-map-markers" style="width: 1024px; height: 768px"></div>

        <script type="text/javascript">  
            showMap();
        </script>

        <!--  The div that is used as the slider container  -->
        <div id="slider"></div>

        <!--        Legende-->
        <div style="padding:20px; border:thin solid black; margin:25px">
            <h1>Legende</h1>
            <ul>
                <li><span style="font-weight:bold; color:#00ff00">Android</span></li>
                <li><span style="font-weight:bold; color:#FF69B4">iOS</span></li>
                <li><span style="font-weight:bold; color:#4169E1">Blackberry</span></li>
                <li><span style="font-weight:bold; color:#ffff00">Windows</span></li>
                <li><span style="font-weight:bold; color:#000000">Andere</span></li>
            </ul>
        </div>
    </body>
</html>


