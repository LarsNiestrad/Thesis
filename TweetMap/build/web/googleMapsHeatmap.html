<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
        <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
        <title>Heatmaps</title>
        <link href="/maps/documentation/javascript/examples/default.css" rel="stylesheet">
        <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">

        <!--        configure the div containers-->
        <style>

            #main {
                position:inherit;
                width:1020px;
                padding:20px;
                margin:auto;
            }
            #heatmapArea {
                position:inherit;
                width:1024px;
                height:768px;
                border:1px dashed black;
                float:left;
            }
            #configArea {
                position:inherit;
                width:200px;
                padding:15px;
                padding-top:0;
                padding-right:0;
                float:right;
            }
            .btn {
                margin-top:25px;
                padding:10px 20px 10px 20px;
                -moz-border-radius:15px;
                -o-border-radius:15px;
                -webkit-border-radius:15px;
                border-radius:15px;
                border:2px solid black;
                cursor:pointer;
                color:white;
                background-color:black;
            }

        </style>
        <!--        Note: The xxx is a placeholder for the key googleMaps offers you. For 
        fourther information visit https://developers.google.com/maps/documentation/javascript/tutorial?hl=de#api_key-->
        <script type="text/javascript"
                src="http://maps.googleapis.com/maps/api/js?key=xxx&sensor=false&libraries=visualization">
        </script>
        <script type="text/javascript">
            function initialize() {
                //load the data via ajax request
                $.getJSON('1Day_10minIntervals.json',function(testData){
                    var map, pointarray, heatmap;
                    var data = testData.tweets[1].geolocation,
                    
                    dataLength = data.length,
                    nudata = [];
                    
                    //transform the data into googlemaps specific objects
                    while(dataLength--){                        
                        nudata[dataLength] = new google.maps.LatLng(data[dataLength][0], data[dataLength][1])
                        
                    };      
                    
                    //setting up the map options
                    var mapOptions = {
                        center: new google.maps.LatLng(52.020417, 8.532222),
                        zoom: 2,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    
                    map = new google.maps.Map(document.getElementById("heatmapArea"),
                    mapOptions);
                
                    //put the data in a point array and pass it to the heatmap layer
                    var pointArray = new google.maps.MVCArray(nudata);
                    var heatmap = new google.maps.visualization.HeatmapLayer({
                        data: pointArray
                    });
                
                    heatmap.setMap(map);
                    
                    //create slider
                    var val=1;
                    $("#slider").slider({
                            
                        value: val,
                        min: 1,
                        max: testData.totalIntervalAmount,
                        step: 1,
                        slide: function( event, ui ) {   
                            $( "#amount" ).val( testData.tweets[ui.value].timestamps[1] );
                            $( "#currentTweetAm").val(testData.tweets[ui.value].ids.length);    
                            data = testData.tweets[ui.value].geolocation;
                            dataLength = data.length;
                            nudata=[];
                                
                            while(dataLength--){
                                nudata[dataLength] = new google.maps.LatLng(data[dataLength][0], data[dataLength][1])
                            }
                            pointArray = new google.maps.MVCArray(nudata);
                            heatmap.setData(pointArray);
                
                            
                        }
                    });
                    $( "#amount" ).val( testData.tweets[1].timestamps[1] );
                    $( "#currentTweetAm").val(testData.tweets[val].ids.length );
                    $( "#allTweetAm").val(testData.totalAmount);
                })
            }
            
            function toggleHeatmap() {
                heatmap.setMap(heatmap.getMap() ? null : map);
            }
            
            
        </script>
    </head>
    <body onload="initialize()">
        <div id="main">
            <h1>Heatmap GoogleMaps</h1>
            <br />

            <!--  slider  -->
            <p>
                <label for="amount">Time:</label>
                <input type="text" size="35" id="amount" style="border: 0; color: #f6931f; font-weight: bold;" />
            </p>

            <p>
                <label for="currentTweetAm">Amount of Tweets of current time interval:</label>
                <input type="text" id="currentTweetAm" style="border: 0; color: #f6931f; font-weight: bold;" />
                <label for="allTweetAm">Total Tweet amount:</label>
                <input type="text" id="allTweetAm" style="border: 0; color: #f6931f; font-weight: bold;" />
            </p>
            <div id="slider"></div>

            <!--            heatmap-->
            <div id="heatmapArea"></div>

            <!--            infobox-->
            <div id="configArea">
                <h2>Description</h2>
                Use the Slider to go through the ten minutes intervales<br/><br/>
            </div>

            <!--            binding in the map-->
            <div style="position:absolute;width:940px;top:750px;text-align:center;">
            </div>
        </div>

    </body>
</html>
